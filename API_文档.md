# æ ‡ä¹¦æ™ºèƒ½ä½“ API æ–‡æ¡£

## è®¿é—®åœ°å€
Webå¹³å°ï¼šhttp://127.0.0.1:5000

---

## ğŸ”¥ æ–°å¢åŠŸèƒ½ï¼ˆ3ã€4ã€5ï¼‰

### 1. æ ‡ä¹¦è´¨é‡è¯„ä¼°
**ç«¯ç‚¹ï¼š** `POST /api/evaluate`

**åŠŸèƒ½ï¼š** è‡ªåŠ¨è¯„ä¼°æ ‡ä¹¦çš„ç»“æ„å®Œæ•´æ€§å’Œå†…å®¹è´¨é‡

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```json
{
  "bid_content": "## æŠ€æœ¯æ–¹æ¡ˆ\né‡‡ç”¨å¾®æœåŠ¡æ¶æ„...",
  "requirements": ["ç³»ç»Ÿé›†æˆåº¦é«˜", "å®æ—¶æ•°æ®å¤„ç†"]
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "evaluation": {
    "structure": {
      "score": 60.0,
      "completeness": "éœ€è¡¥å……",
      "found": ["é¡¹ç›®ç†è§£", "æŠ€æœ¯æ–¹æ¡ˆ"],
      "missing": ["éœ€æ±‚åˆ†æ", "ç³»ç»Ÿè®¾è®¡", "å›¢é˜Ÿ"]
    },
    "content_quality": {
      "score": 40,
      "level": "éœ€æ”¹è¿›",
      "metrics": {
        "word_count": 500,
        "paragraph_count": 5,
        "has_tables": false,
        "has_lists": true
      }
    },
    "overall_score": 48.0,
    "overall_level": "éœ€æ”¹è¿›",
    "recommendations": [
      "å»ºè®®è¡¥å……ç¼ºå¤±ç« èŠ‚ï¼šéœ€æ±‚åˆ†æ, ç³»ç»Ÿè®¾è®¡",
      "å†…å®¹åå°‘ï¼Œå»ºè®®æ‰©å……å„ç« èŠ‚å†…å®¹",
      "å»ºè®®æ·»åŠ è¡¨æ ¼å¢å¼ºå¯è¯»æ€§"
    ]
  }
}
```

---

### 2. æ ‡ä¹¦å¯¼å‡º
**ç«¯ç‚¹ï¼š** `POST /api/export`

**åŠŸèƒ½ï¼š** å°†æ ‡ä¹¦å¯¼å‡ºä¸ºWordæˆ–Markdownæ–‡æ¡£

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```json
{
  "bid_content": "# æ ‡ä¹¦æ–¹æ¡ˆ\n\n## æŠ€æœ¯æ–¹æ¡ˆ\n...",
  "metadata": {
    "project_name": "æ™ºæ…§åŸå¸‚å¹³å°",
    "company": "XXç§‘æŠ€æœ‰é™å…¬å¸",
    "date": "2026-01-31"
  },
  "format": "all"
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "result": {
    "word": "./æ™ºæ…§åŸå¸‚å¹³å°_20260131_164233.docx",
    "markdown": "./æ™ºæ…§åŸå¸‚å¹³å°_20260131_164233.md",
    "success": true
  }
}
```

**æ”¯æŒæ ¼å¼ï¼š**
- `all` - åŒæ—¶å¯¼å‡ºWordå’ŒMarkdownï¼ˆé»˜è®¤ï¼‰
- `word` - ä»…å¯¼å‡ºWord
- `markdown` - ä»…å¯¼å‡ºMarkdown

---

### 3. å¤šè½®å¯¹è¯
**ç«¯ç‚¹ï¼š** `POST /api/chat`

**åŠŸèƒ½ï¼š** ä¸AIåŠ©æ‰‹äº¤äº’å¼åœ°åˆ›å»ºå’Œå®Œå–„æ ‡ä¹¦

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```json
{
  "message": "è¯·å¸®æˆ‘å®Œå–„æŠ€æœ¯æ–¹æ¡ˆéƒ¨åˆ†",
  "context": {
    "bid_state": {
      "project_name": "æ™ºæ…§åŸå¸‚å¹³å°",
      "requirements": ["ç³»ç»Ÿé›†æˆåº¦é«˜"]
    }
  }
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "response": "å¥½çš„ï¼Œæˆ‘æ¥å¸®æ‚¨å®Œå–„æŠ€æœ¯æ–¹æ¡ˆ...",
  "summary": {
    "total_messages": 10,
    "project_name": "æ™ºæ…§åŸå¸‚å¹³å°",
    "has_bid": true
  }
}
```

**å¯¹è¯ç¤ºä¾‹æµç¨‹ï¼š**
1. "ä½ å¥½ï¼Œæˆ‘éœ€è¦ç¼–å†™æ ‡ä¹¦"
2. "é¡¹ç›®æ˜¯æ™ºæ…§åŸå¸‚å¹³å°"
3. "æŠ€æœ¯æ–¹æ¡ˆåº”è¯¥é‡‡ç”¨å¾®æœåŠ¡æ¶æ„"
4. "è¯·å¸®æˆ‘å®Œå–„å›¢é˜Ÿé…ç½®éƒ¨åˆ†"
5. "ç”Ÿæˆå®Œæ•´æ ‡ä¹¦"

---

### 4. é‡ç½®å¯¹è¯
**ç«¯ç‚¹ï¼š** `POST /api/conversation/reset`

**åŠŸèƒ½ï¼š** æ¸…ç©ºå¯¹è¯å†å²ï¼Œé‡æ–°å¼€å§‹

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "å¯¹è¯å·²é‡ç½®"
}
```

---

### 5. å‘é‡æ£€ç´¢
**ç«¯ç‚¹ï¼š** `POST /api/vector/search`

**åŠŸèƒ½ï¼š** æ£€ç´¢ç›¸ä¼¼çš„å†å²æ ‡ä¹¦ç‰‡æ®µä½œä¸ºå‚è€ƒ

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```json
{
  "query": "å¾®æœåŠ¡æ¶æ„è®¾è®¡",
  "doc_type": "technical_solution",
  "top_k": 3
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "results": [
    {
      "doc_type": "technical_solution",
      "content": "é‡‡ç”¨å¾®æœåŠ¡æ¶æ„è®¾è®¡ï¼Œç³»ç»Ÿåˆ†ä¸ºç”¨æˆ·å±‚ã€åº”ç”¨å±‚ã€æœåŠ¡å±‚å’Œæ•°æ®å±‚...",
      "metadata": {"project": "æ™ºæ…§åŸå¸‚", "quality": "high"},
      "score": 202.446
    }
  ],
  "count": 1
}
```

**æ–‡æ¡£ç±»å‹ï¼š**
- `technical_solution` - æŠ€æœ¯æ–¹æ¡ˆ
- `team_structure` - å›¢é˜Ÿç»“æ„
- `quality_assurance` - è´¨é‡ä¿éšœ
- `implementation_plan` - å®æ–½è®¡åˆ’
- `after_sales` - å”®åæœåŠ¡

---

## ğŸ“Œ åŸæœ‰åŠŸèƒ½

### ç³»ç»ŸçŠ¶æ€
**ç«¯ç‚¹ï¼š** `GET /api/status`

**åŠŸèƒ½ï¼š** æ£€æŸ¥æ‰€æœ‰ç³»ç»Ÿç»„ä»¶çŠ¶æ€

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "database": true,
  "milvus": true,
  "ollama": true,
  "modules": {
    "vector_store": true,
    "evaluator": true,
    "exporter": true,
    "conversation": true
  }
}
```

---

### ç”Ÿæˆæ ‡ä¹¦
**ç«¯ç‚¹ï¼š** `POST /api/generate_bid`

**åŠŸèƒ½ï¼š** æ ¹æ®é¡¹ç›®ä¿¡æ¯ç”Ÿæˆå®Œæ•´æ ‡ä¹¦

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```json
{
  "project_name": "æ™ºæ…§åŸå¸‚ç»¼åˆç®¡ç†å¹³å°",
  "project_description": "å»ºè®¾é›†äº¤é€šç®¡ç†ã€ç¯å¢ƒç›‘æµ‹ã€å…¬å…±å®‰å…¨ç­‰åŠŸèƒ½äºä¸€ä½“çš„æ™ºæ…§åŸå¸‚ç»¼åˆç®¡ç†å¹³å°...",
  "requirements": [
    "ç³»ç»Ÿé›†æˆåº¦é«˜",
    "å®æ—¶æ•°æ®å¤„ç†",
    "AIæ™ºèƒ½åˆ†æ"
  ]
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "bid_document": "# æ™ºæ…§åŸå¸‚ç»¼åˆç®¡ç†å¹³å°\n\n## ä¸€ã€é¡¹ç›®ç†è§£ä¸éœ€æ±‚åˆ†æ...",
  "staff_used": 10,
  "products_used": 8
}
```

---

### æŸ¥è¯¢å‘˜å·¥
**ç«¯ç‚¹ï¼š** `GET /api/staff`

**åŠŸèƒ½ï¼š** è·å–å¯ç”¨å‘˜å·¥åˆ—è¡¨

---

### æŸ¥è¯¢äº§å“
**ç«¯ç‚¹ï¼š** `GET /api/products`

**åŠŸèƒ½ï¼š** è·å–å¯ç”¨äº§å“åˆ—è¡¨

---

## ğŸ§ª æµ‹è¯•è„šæœ¬

è¿è¡Œå®Œæ•´åŠŸèƒ½æµ‹è¯•ï¼š
```bash
python test_enhanced_features.py
```

æµ‹è¯•å†…å®¹åŒ…æ‹¬ï¼š
1. ç³»ç»ŸçŠ¶æ€æ£€æŸ¥
2. æ ‡ä¹¦è´¨é‡è¯„ä¼°
3. æ ‡ä¹¦å¯¼å‡ºï¼ˆWord + Markdownï¼‰
4. å¤šè½®å¯¹è¯
5. å‘é‡æ£€ç´¢

---

## ğŸ“¦ é¡¹ç›®æ¨¡å—

| æ¨¡å— | æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|------|
| å‘é‡å­˜å‚¨ | vector_store.py | Milvuså‘é‡æ£€ç´¢ |
| è´¨é‡è¯„ä¼° | bid_evaluator.py | è‡ªåŠ¨è¯„ä¼°æ ‡ä¹¦è´¨é‡ |
| å¯¼å‡º | bid_exporter.py | å¯¼å‡ºWord/Markdown |
| å¯¹è¯ | bid_conversation.py | å¤šè½®äº¤äº’å¼ç”Ÿæˆ |
| Flaskåº”ç”¨ | app_enhanced.py | Web APIæœåŠ¡ |

---

## ğŸ¯ ä½¿ç”¨å»ºè®®

1. **ç”Ÿæˆæ ‡ä¹¦** â†’ ä½¿ç”¨ `/api/generate_bid`
2. **è¯„ä¼°è´¨é‡** â†’ ä½¿ç”¨ `/api/evaluate`
3. **å®Œå–„å†…å®¹** â†’ ä½¿ç”¨ `/api/chat` å¤šè½®å¯¹è¯
4. **å¯¼å‡ºæ–‡æ¡£** â†’ ä½¿ç”¨ `/api/export`
5. **å‚è€ƒå†å²** â†’ ä½¿ç”¨ `/api/vector/search`

---

## ğŸ’¡ æœ€ä½³å®è·µ

- å…ˆè°ƒç”¨ `/api/generate_bid` ç”Ÿæˆåˆå§‹æ ‡ä¹¦
- ç”¨ `/api/evaluate` æ£€æŸ¥è´¨é‡
- é€šè¿‡ `/api/chat` é€æ­¥å®Œå–„è–„å¼±ç« èŠ‚
- ä½¿ç”¨ `/api/vector/search` æŸ¥æ‰¾ç›¸ä¼¼é¡¹ç›®å‚è€ƒ
- æœ€åç”¨ `/api/export` å¯¼å‡ºWordæ–‡æ¡£

---

*æœ€åæ›´æ–°ï¼š2026-01-31*
